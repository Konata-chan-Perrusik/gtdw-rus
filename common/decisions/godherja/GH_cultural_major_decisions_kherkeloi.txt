#KHERKELOI DECISIONS

revive_ertomax_kingdom_decision = {
	picture = { reference = "gfx/interface/illustrations/decisions/decision_destiny_goal.dds" }
	decision_group_type = major

	ai_check_interval = 120

	desc = revive_ertomax_kingdom_decision_desc
	selection_tooltip = revive_ertomax_kingdom_decision_tooltip

	is_shown = {
		is_ruler = yes
		is_playable_character = yes
		exists = dynasty
		OR = {
			culture = culture:jarakmar
			has_religion = religion:aruvasue_religion
		}
		NOT = {
			is_target_in_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:revive_ertomax_kingdom_decision
			}
		}
	}

	is_valid = {
		is_independent_ruler = yes
		highest_held_title_tier <= tier_duchy
		prestige_level >= 4
		has_title = title:d_murdetaal
		has_title = title:d_karcord
		has_title = title:d_hutstearv
		has_title = title:d_serbar
	}

	is_valid_showing_failures_only = {
		is_available_adult = yes
	}
	
	effect = {
		save_scope_as = ertomax_restorer
		show_as_tooltip = { revive_ertomax_kingdom_decision_effects = yes }
		trigger_event = kherkeloi.0001
		every_player = {
			limit = {
				NOT = { this = scope:ertomax_restorer }
				is_within_diplo_range = { CHARACTER = scope:ertomax_restorer }
			}
			trigger_event = kherkeloi.0002
		}
		add_to_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:revive_ertomax_kingdom_decision
		}
		GH_achiev_lunarsunrise_check = yes
	}

	cost = {
		gold = 300
	}

	ai_potential = {
		always = yes
	}

	ai_will_do = {
		base = 100
	}
}

restore_astilik_empire_decision = {
	picture = { reference = "gfx/interface/illustrations/decisions/ep3_cerimonial_decision.dds" }
	desc = restore_astilik_empire_decision_desc
	selection_tooltip = restore_astilik_empire_decision_tooltip
	decision_group_type = major

	ai_check_interval = 120

	is_shown = {
		is_playable_character = yes
		highest_held_title_tier < tier_empire
		OR = {
			religion = religion:astiliak_religion
			culture = culture:astilik
		}
		capital_province = { geographical_region = custom_astilik_empire }
		NOT = { exists = title:e_astilik_empire.holder }
	}

	is_valid = {
		is_independent_ruler = yes
		prestige_level >= 4
		highest_held_title_tier = tier_kingdom
		completely_controls_region = custom_astilik_empire_core
		OR = {
			AND = {
				custom_tooltip = {
					text = restore_astilik_empire_decision_north_tt
					any_county_in_region = {
						region = custom_astilik_empire_north
						percent >= astilik_empire_formable_percent_decimal_value
						holder.top_liege = root
					}
				}
				custom_tooltip = {
					text = restore_astilik_empire_decision_north_county_tt
					title:c_asiupoli.holder = {
						OR = {
							this = root
							any_liege_or_above = { this = root }
						}
					}
				}
			}
			AND = {
				custom_tooltip = {
					text = restore_astilik_empire_decision_east_tt
					any_county_in_region = {
						region = custom_astilik_empire_east
						percent >= astilik_empire_formable_percent_decimal_value
						holder.top_liege = root
					}
				}
				custom_tooltip = {
					text = restore_astilik_empire_decision_east_county_tt
					title:c_tsetarva.holder = {
						OR = {
							this = root
							any_liege_or_above = { this = root }
						}
					}
				}
			}
		}
	}

	is_valid_showing_failures_only = {
		is_landed = yes
		is_available_adult = yes
	}

	cost = {
		prestige = 2000
		piety = 1000
	}

	effect = {
		save_scope_as = restorer
		gain_legitimizing_legend_seed_tooltip_effect = yes
		show_as_tooltip = {
			create_title_and_vassal_change = {
				type = created
				save_scope_as = title_change
				add_claim_on_loss = no
			}
			title:e_astilik_empire = {
				change_title_holder = {
					holder = scope:restorer
					change = scope:title_change
				}
			}
			resolve_title_and_vassal_change = scope:title_change
		}
		custom_tooltip = restore_astilik_empire_decision_effect_north_tt
		custom_tooltip = restore_astilik_empire_decision_effect_east_tt
		show_as_tooltip = {
			if = {
				limit = { capital_county.culture = { NOT = { this = root.culture } } }
				capital_county = { set_county_culture = root.culture }
				if = {
					limit = { capital_county.faith = { NOT = { this = root.faith } } }
					capital_county = { set_county_faith = root.faith }
				}
			}
		}
		trigger_event = kherkeloi.0003
		every_player = {
			limit = {
				NOT = { this = root }
				is_within_diplo_range = { CHARACTER = root }
			}
			trigger_event = kherkeloi.0004
		}
		set_global_variable = {
			name = restored_astilik_empire
			value = root
		}
	}

	ai_potential = {
		OR = {
			religion = religion:astiliak_religion
			culture = culture:astilik
		}
	}

	ai_will_do = {
		base = 100
	}
}

patronize_halite_temple_decision = {
	picture = { reference = "gfx/interface/illustrations/decisions/decision_golden_age.dds" }
	desc = patronize_halite_temple_decision_desc
	selection_tooltip = patronize_halite_temple_decision_tooltip
	decision_group_type = major

	ai_check_interval = 120

	is_shown = {
		is_playable_character = yes
		title:b_theophanoeras = { is_holy_site_of = root.faith }
		culture = {
			NOT = {
				is_target_in_global_variable_list = {
					name = culture_patronized_halite_temple
					target = this
				}
			}
		}
	}

	is_valid = {
		is_independent_ruler = yes
		piety_level >= 3
		highest_held_title_tier > tier_duchy
		title:b_theophanoeras.title_province = { has_building = 02_halite_temple }
		custom_tooltip = {
			text = patronize_halite_temple_decision_culture_head_tooltip
			culture.culture_head = root
		}
	}

	is_valid_showing_failures_only = {
		is_landed = yes
		is_available_adult = yes
	}

	cost = {
		gold = 1000
		prestige = 2000
	}

	effect = {
		save_scope_as = patron
		gain_holy_legend_seed_tooltip_effect = yes
		show_as_tooltip = {
			add_piety_level = 1
			if = {
				limit = { culture = { culture_knows_magic_school = { MAGIC_SCHOOL = global_var:wane_tender_harmoniarchy } } }
				custom_tooltip = patronize_halite_temple_decision_effect_mastery_tooltip
			}
			else = { custom_tooltip = patronize_halite_temple_decision_effect_school_tooltip }
			spawn_army = {
				name = halite_temple_guards_army
				location = root.location
				men_at_arms = {
					type = handpicked_faithful
					stacks = 4
				}
				inheritable = yes
				uses_supply = yes
			}
		}
		trigger_event = kherkeloi.0005
		every_player = {
			limit = {
				NOT = { this = root }
				culture = root.culture
			}
			trigger_event = kherkeloi.0006
		}
		culture = {
			add_to_global_variable_list = {
				name = culture_patronized_halite_temple
				target = this
			}
		}
	}

	ai_potential = {
		always = yes
	}

	ai_will_do = {
		base = 100
	}
}