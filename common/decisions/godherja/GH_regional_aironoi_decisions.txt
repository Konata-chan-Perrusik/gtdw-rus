##################
##DECISIONS LIST##
# investigate_valerix_decision
# free_the_slaves_decision
# invade_fenvir_clanrech_decision
# become_king_taykovi_decision
##################

##################
# Investigate Valerix
# by Lonely Knight
investigate_valerix_decision = {
	picture = {
		reference = "gfx/interface/illustrations/decisions/decision_misc.dds"
	}
	decision_group_type = story
	ai_check_interval = 120
	desc = investigate_valerix_decision_desc

	is_shown = {
		AND = {
			has_title_legio_lxi_anoterion_trigger = yes
			character_hecaeda_trigger = yes
		}
		has_game_rule = story_content_enabled
		NOT = {
			is_target_in_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:investigate_valerix_decision
			}
			is_target_in_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:eastern_reforms_picked_side
			}
		}
	}

	is_valid = {
		gold >= 200
	}

	cost = {
		gold = {
			value = 200
		}
	}
	
	effect = {

		#Events
		trigger_event = eastern_reforms.0001

		#Can only be done once
		add_to_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:investigate_valerix_decision
		}
	}
	

	ai_potential = {
		always = yes
	}

	ai_will_do = {
		base = 100
	}
}

##################
# Free the Slaves
# by Lonely Knight
free_the_slaves_decision = {
	picture = {
		reference = "gfx/interface/illustrations/decisions/decision_recruitment.dds"
	}
	decision_group_type = story
	ai_check_interval = 120
	desc = free_the_slaves_decision_desc

	is_shown = {
		has_character_flag = the_governor_is_purged
		has_game_rule = story_content_enabled
		any_held_title = {
			trigger_if = {
				limit = { tier = tier_kingdom }
			}
			trigger_else = { always = no }
		}
		NOT = {
			is_target_in_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:free_the_slaves_1
			}
		}
	}

	is_valid = {
		custom_description = {
			text = free_the_slaves_generic_valid_desc

			is_at_war = no
			prestige >= 300
			AND = {
				has_title_legio_lxi_anoterion_trigger = yes
				character_hecaeda_trigger = yes # GH TODO: Add a 'slave liberator' character flag or something that triggers this instead - then give it to slave rebels
			}
		}
	}

	effect = {
		#Events
		#trigger_event = aironoi.0001


		aironoi_free_slaves_effect = yes
		add_prestige = -150
		spawn_army = {
			name = freed_slaves
			location = capital_province
			inheritable = no
			levies = 500
		}
		add_to_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:free_the_slaves_1
		}
	}
	

	ai_potential = {
		always = yes
	}

	ai_will_do = {
		base = 100
	}
}

##################
# Free the Slaves
# by Lonely Knight
free_the_slaves_decision_2 = {
	picture = {
		reference = "gfx/interface/illustrations/decisions/decision_recruitment.dds"
	}
	decision_group_type = story
	ai_check_interval = 120
	desc = free_the_slaves_decision_desc

	is_shown = {
		has_character_flag = the_governor_is_purged
		has_game_rule = story_content_enabled
		any_sub_realm_county = { title_province = { geographical_region = world_ga_aironoi } }
		any_held_title = {
			trigger_if = {
				limit = { tier = tier_kingdom }
			}
			trigger_else = { always = no }
		}
		is_target_in_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:free_the_slaves_1
		}
		NOT = {
			is_target_in_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:free_the_slaves_2
			}
		}
	}

	is_valid = {
		completely_controls = title:d_tower_isles
		custom_description = {
			text = free_the_slaves_decision_2_desc
			is_at_war = no
			prestige >= 200
			AND = {
				has_title_legio_lxi_anoterion_trigger = yes
				character_hecaeda_trigger = yes
			}
			completely_controls = title:d_tower_isles
			
		} 
	}

	effect = {
		#Events
		#trigger_event = aironoi.0001 # GH TODO: Reimplement - unique loc per region


		aironoi_free_slaves_effect = yes
		add_prestige = -150
		spawn_army = {
			name = freed_slaves
			location = capital_province
			inheritable = no
			levies = 200
		}
		add_to_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:free_the_slaves_2
		}
	}
	

	ai_potential = {
		always = yes
	}

	ai_will_do = {
		base = 100
	}
}

##################
# Free the Slaves
# by Lonely Knight
free_the_slaves_decision_3 = { # Lasanoi duchy 
	picture = {
		reference = "gfx/interface/illustrations/decisions/decision_recruitment.dds"
	}
	decision_group_type = story
	ai_check_interval = 120
	desc = free_the_slaves_decision_desc

	is_shown = {
		has_character_flag = the_governor_is_purged
		has_game_rule = story_content_enabled
		any_held_title = {
			trigger_if = {
				limit = { tier = tier_kingdom }
			}
			trigger_else = { always = no }
		}
		is_target_in_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:free_the_slaves_1
		}
		NOT = {
			is_target_in_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:free_the_slaves_3
			}
		}
	}

	is_valid = {
		completely_controls = title:d_lasanoi
		custom_description = {
			text = free_the_slaves_decision_3_desc

			is_at_war = no
			prestige >= 350
			AND = {
				has_title_legio_lxi_anoterion_trigger = yes
				character_hecaeda_trigger = yes
			}
			completely_controls = title:d_lasanoi
		}
	}
 
	effect = {
		#Events
		#trigger_event = aironoi.0001


		aironoi_free_slaves_effect = yes
		add_prestige = -150
		spawn_army = {
			name = freed_slaves
			location = capital_province
			inheritable = no
			levies = 350
		}
		add_to_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:free_the_slaves_3
		}
	}
	

	ai_potential = {
		always = yes
	}

	ai_will_do = {
		base = 100
	}
}

##################
# Free the Slaves in Svatavego
# by Lonely Knight
free_the_slaves_decision_4 = {
	picture = {
		reference = "gfx/interface/illustrations/decisions/decision_recruitment.dds"
	}
	decision_group_type = story
	ai_check_interval = 120
	desc = free_the_slaves_decision_desc

	is_shown = {
		has_character_flag = the_governor_is_purged
		has_game_rule = story_content_enabled
		any_held_title = {
			trigger_if = {
				limit = { tier = tier_kingdom }
			}
			trigger_else = { always = no }
		}
		AND = {
			is_target_in_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:free_the_slaves_1
			}
			is_target_in_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:free_the_slaves_3
			}
		}
		NOT = {
			is_target_in_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:free_the_slaves_4
			}
		}
	}

	is_valid = {
		completely_controls = title:k_svatavego
		custom_description = {
			text = free_the_slaves_decision_4_desc

			is_at_war = no
			prestige >= 500
			AND = {
				has_title_legio_lxi_anoterion_trigger = yes
				character_hecaeda_trigger = yes
			}
			completely_controls = title:k_svatavego
		}
	}

	effect = {
		#Events
		#trigger_event = aironoi.0001


		aironoi_free_slaves_effect = yes
		add_prestige = -150
		spawn_army = {
			name = freed_slaves
			location = capital_province
			inheritable = no
			levies = 1000
			men_at_arms = {
				type = light_footmen
				stacks = 2
			}
		}
		add_to_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:free_the_slaves_4
		}
	}
	

	ai_potential = {
		always = yes
	}

	ai_will_do = {
		base = 100
	}
}


##################
# Free the Slaves in He Vrerai
# by Lonely Knight
free_the_slaves_decision_5 = {
	picture = {
		reference = "gfx/interface/illustrations/decisions/decision_recruitment.dds"
	}
	decision_group_type = story
	ai_check_interval = 120
	desc = free_the_slaves_decision_desc

	is_shown = {
		has_character_flag = the_governor_is_purged
		has_game_rule = story_content_enabled
		any_held_title = {
			trigger_if = {
				limit = { tier = tier_kingdom }
			}
			trigger_else = { always = no }
		}
		is_target_in_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:free_the_slaves_1
		}
		NOT = {
			is_target_in_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:free_the_slaves_5
			}
		}
	}

	is_valid = {
		completely_controls = title:d_he_vrerai
		custom_description = {
			text = free_the_slaves_decision_5_desc

			is_at_war = no
			prestige >= 300
			AND = {
				has_title_legio_lxi_anoterion_trigger = yes
				character_hecaeda_trigger = yes
			}
			completely_controls = title:d_he_vrerai
		}
	}

	effect = {
		#Events
		#trigger_event = aironoi.0001


		aironoi_free_slaves_effect = yes
		add_prestige = -150
		spawn_army = {
			name = freed_slaves
			location = capital_province
			inheritable = no
			levies = 300
		}
		add_to_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:free_the_slaves_5
		}
	}
	

	ai_potential = {
		always = yes
	}

	ai_will_do = {
		base = 100
	}
}

##################
# Free the Slaves of Hyrea
# by Lonely Knight
free_the_slaves_decision_6 = {
	picture = {
		reference = "gfx/interface/illustrations/decisions/decision_recruitment.dds"
	}
	decision_group_type = story
	ai_check_interval = 120
	desc = free_the_slaves_decision_desc 

	is_shown = {
		has_character_flag = the_governor_is_purged
		has_game_rule = story_content_enabled
		any_held_title = {
			trigger_if = {
				limit = { tier = tier_kingdom }
			}
			trigger_else = { always = no }
		}
		AND = {
			is_target_in_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:free_the_slaves_1
			}
			is_target_in_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:free_the_slaves_5
			}
		}
		NOT = {
			is_target_in_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:free_the_slaves_6
			}
		}
	}

	is_valid = {
		completely_controls = title:d_he_vrerai
		completely_controls = title:c_calion
		completely_controls = title:c_kosios
		custom_description = { 
			text = free_the_slaves_decision_6_desc

			is_at_war = no
			prestige >= 500
			AND = {
				has_title_legio_lxi_anoterion_trigger = yes
				character_hecaeda_trigger = yes
			}
			completely_controls = title:d_he_vrerai
			completely_controls = title:c_calion
			completely_controls = title:c_kosios
		}
	}

	effect = {
		#Events
		#trigger_event = aironoi.0001


		aironoi_free_slaves_effect = yes
		add_prestige = -150
		spawn_army = {
			name = freed_slaves
			location = capital_province
			inheritable = no
			levies = 1000
			men_at_arms = {
				type = light_footmen
				stacks = 2
			}
		}
		add_to_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:free_the_slaves_6
		}
	}
	

	ai_potential = {
		always = yes
	}

	ai_will_do = {
		base = 100
	}
}

##################
# Emancipate the Slaves of Aironoi
# by ThatOneGuy
emancipate_the_slaves_decision = {
	picture = {
		reference = "gfx/interface/illustrations/decisions/decision_recruitment.dds"
	}
	decision_group_type = story
	ai_check_interval = 120
	desc = emancipate_the_slaves_decision_desc

	is_shown = {
		has_character_flag = the_governor_is_purged
		has_game_rule = story_content_enabled
		NOT = {
			is_target_in_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:free_the_slaves_decision
			}
		}
	}

	is_valid = {
		is_at_war = no
		prestige >= 1000
		AND = {
			has_title_legio_lxi_anoterion_trigger = yes
			character_hecaeda_trigger = yes
		}
		completely_controls = title:c_asiupoli
		completely_controls = title:k_kalliados
	}

	effect = {
		#Events
		#trigger_event = aironoi.0001

		add_to_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:free_the_slaves_decision
		}
		asiupoli_free_slaves_effect = yes
		add_prestige = -200
		spawn_army = {
			name = freed_slaves
			location = capital_province
			inheritable = no
			levies = 3000
			men_at_arms = {
				type = light_footmen
				stacks = 3
			}
		}
	}
	

	ai_potential = {
		always = yes
	}

	ai_will_do = {
		base = 100
	}
}



##################
# Invade Fenvir Clanrech
# by Lonely Knight
invade_fenvir_clanrech_decision = {
	picture = {
		reference = "gfx/interface/illustrations/decisions/decision_destiny_goal.dds"
	}
	decision_group_type = story
	ai_check_interval = 12
	desc = invade_fenvir_clanrech_decision_desc

	is_shown = {
		has_game_rule = story_content_enabled
		AND = {
			has_title_legio_lxi_anoterion_trigger = yes
			character_hecaeda_trigger = yes
		}
		OR = {
			has_character_flag = the_governor_is_purged
			has_character_flag = sided_with_governor # This should technically be a post-war flag, but this works for now
		}
		NOT = {
			completely_controls = title:c_asiupoli
			is_target_in_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:eastern_reforms_invade_fenvir_clanrech
			}
		}
	}

	is_valid = {
		is_at_war = no
		prestige >= 1500
		NOT = { completely_controls = title:c_asiupoli }
	}

	effect = {
		show_as_tooltip = {
			custom_tooltip = invade_fenvir_clanrech_decision_tt
		}
		add_prestige = -1000
		if = {
			limit = {
				has_character_flag = sided_with_mongols
			}
			trigger_event = eastern_reforms.0007
		}
		else = {
			limit = {
				has_character_flag = sided_with_governor
			}
			trigger_event = eastern_reforms.0011
		}
		add_to_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:eastern_reforms_invade_fenvir_clanrech
		}
	}
}


the_scarred_rise_up = {
	picture = {
		reference = "gfx/interface/illustrations/decisions/decision_invite_knights.dds"
	}
	decision_group_type = kashiryan
	ai_check_interval = 120
	desc = the_scarred_rise_up_desc

	is_shown = {
		has_game_rule =  story_content_enabled
		has_title = title:d_jhanadahoo
		NOT = {
			is_target_in_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:the_scarred_are_free	
		   }
		}
	}	
	is_valid = {
		is_independent_ruler = no
		prestige >= 200
	}
	effect = {
		show_as_tooltip = {
			custom_tooltip = the_scarred_rise_up_tt
		}
		spawn_army = {
			name = azaki_mard
			location = capital_province
			inheritable = no
			men_at_arms = {
				type = jaanvarkis
				stacks = 10
			}
		}
		
		add_to_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:the_scarred_are_free
		}
	}	
}	

##Belisarios as King, by Matt

become_king_taykovi_decision = {
	picture = {
		reference = "gfx/interface/illustrations/decisions/decision_ck2_suspicious_noble.dds"
	}
	decision_group_type = story
	ai_check_interval = 120

	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					NOT = {
						character:westernimperial_aeschraes_aagiokrata_1 = {
							is_alive = yes
						}
						character:southernimperial_aversarian_gorassos_1 = {
							is_alive = yes
						}
						character:southernimperial_aversarian_gorassos_2 = {
							is_alive = yes
						}
					}
				}
				desc = become_king_taykovi_decision_enemies_dead
			}
			desc = become_king_taykovi_decision_desc
		}
	}

	is_shown = {
		highest_held_title_tier < 4
		AND = {
			character_belisarios_trigger = yes
		}
		has_game_rule = story_content_enabled
		#any_sub_realm_county = { title_province = { geographical_region = belisarios_kingdom_taykovi } }
		NOT = {
			is_target_in_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:become_king_taykovi_decision
			}
		}
	}

	is_valid = {
		gold >= 250
		prestige_level >= 2
		has_title = title:c_murun
		OR = {
			completely_controls = title:d_taliron
			completely_controls = title:d_nugool
		}
		AND = {
			custom_description = {
				text = belisarios_enemies_dead_desc
				NOT = {
					character:westernimperial_aeschraes_aagiokrata_1 = {
						is_alive = yes
					}
					character:southernimperial_aversarian_gorassos_1 = {
						is_alive = yes
					}
					character:southernimperial_aversarian_gorassos_2 = {
						is_alive = yes
					}
				}
			}
		}
	}

	cost = {
		gold = {
			value = 250
		}
	}
	
	effect = {
		#Can only be done once
		get_title = title:k_taykovi
		trigger_event = gh_belisarios_events.0001
		add_to_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:become_king_taykovi_decision
		}
	}

	ai_potential = {
		always = yes
	}

	ai_will_do = {
		base = 100
	}
}

belisarios_tries_to_forget = {
	picture = {
		reference = "gfx/interface/illustrations/decisions/decision_personal_religious.dds"
	}
	decision_group_type = story
	ai_check_interval = 120

	is_shown = {
		highest_held_title_tier >= 3
		AND = {
			character_belisarios_trigger = yes
		}
		has_game_rule = story_content_enabled
		NOT = {
			has_trait = ambitious
			is_target_in_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:belisarios_forgot
			}
		}
	}

	is_valid = {
		has_trait = vengeful
		has_trait = depressed_1
		custom_description = {
			text = belisarios_enemies_dead_desc
			NOT = {
				character:westernimperial_aeschraes_aagiokrata_1 = {
					is_alive = yes
				}
				character:southernimperial_aversarian_gorassos_1 = {
					is_alive = yes
				}
				character:southernimperial_aversarian_gorassos_2 = {
					is_alive = yes
				}
			}
		}
	}
	
	effect = {
		trigger_event = gh_belisarios_events.0001
		add_to_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:belisarios_forgot
		}
		GH_achiev_iamvengeance_check = yes
	}

	ai_potential = {
		always = yes
	}

	ai_will_do = {
		base = 100
	}
}