
initialize_global_knowledge_entries_effect = {
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = basics_of_human_anatomy BONUS = add_trait_xp_lifestyle_physician SCALE = major_trait_xp SKILL = learning DIFFICULTY = average_skill_level }
	
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = three_humors BONUS = add_trait_xp_lifestyle_physician SCALE = medium_trait_xp SKILL = lifestyle_physician DIFFICULTY = 5 }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = blood SCALE = 1 }
	
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = mechanics_of_the_heart BONUS = add_trait_xp_lifestyle_physician SCALE = medium_trait_xp SKILL = lifestyle_physician DIFFICULTY = 20 }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = blood SCALE = 1 }

	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = methods_of_vivisection BONUS = add_trait_xp_lifestyle_physician SCALE = major_trait_xp SKILL = lifestyle_physician DIFFICULTY = 20 }
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = vitae_extraction_and_storage BONUS = add_trait_xp_lifestyle_physician SCALE = minor_trait_xp SKILL = lifestyle_physician DIFFICULTY = 10 }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = blood SCALE = 2 }
	# GH URGENT: This spell is commented out
	#create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = the_five_torments_procedure BONUS = learn_spell SCALE = 1 SKILL = lifestyle_physician DIFFICULTY = 35 }
	#scope:new_knowledge_entry_scope ?= {
	#	add_to_variable_list = {
	#		name = knowledge_entry_spell_list
	#		target = global_var:five_torments_procedure
	#	}
	#}
		
	#############
	# DIPLOMACY #
	#############
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = testament_to_yunusfur_hudi BONUS = diplomacy SCALE = 1 SKILL = learning DIFFICULTY = poor_skill_level }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = light SCALE = 1 }
		
	###########
	# MARTIAL #
	###########
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = on_prudent_leadership BONUS = martial SCALE = 1 SKILL = learning DIFFICULTY = poor_skill_level }
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = on_battlefield_survival BONUS = martial SCALE = 1 SKILL = learning DIFFICULTY = poor_skill_level }
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = on_personal_valour BONUS = prowess SCALE = 1 SKILL = learning DIFFICULTY = poor_skill_level }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = add_trait_xp_lifestyle_tourney_participant_foot SCALE = 10 }
	
	############
	# LEARNING #
	############
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = testament_to_yunusfur_el_qulatha BONUS = learning SCALE = 1 SKILL = learning DIFFICULTY = poor_skill_level }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = light SCALE = 1 }

	
	############
	# PROWESS #
	############
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = duelist_adventurer BONUS = martial SCALE = 1 SKILL = learning DIFFICULTY = average_skill_level }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = prowness SCALE = 5 }
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = godherja BONUS = prowess SCALE = 2 SKILL = learning DIFFICULTY = good_skill_level }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = nature SCALE = 2 }

	##########
	# BOTANY #
	##########
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = botany_agrimony BONUS = dream SCALE = 1 SKILL = learning DIFFICULTY = average_skill_level }
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = botany_berries BONUS = stewardship SCALE = 1 SKILL = learning DIFFICULTY = poor_skill_level }
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = botany_carnation BONUS = blood SCALE = 1 SKILL = learning DIFFICULTY = average_skill_level }
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = botany_celeries BONUS = stewardship SCALE = 1 SKILL = learning DIFFICULTY = average_skill_level }
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = botany_cinnamon BONUS = fire SCALE = 1 SKILL = learning DIFFICULTY = average_skill_level }
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = botany_coneflowers BONUS = air SCALE = 1 SKILL = learning DIFFICULTY = average_skill_level }
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = botany_dandelions BONUS = nature SCALE = 1 SKILL = learning DIFFICULTY = good_skill_level }
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = botany_grapes BONUS = stewardship SCALE = 1 SKILL = learning DIFFICULTY = average_skill_level }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = blood SCALE = 1 }
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = botany_grasses BONUS = nature SCALE = 2 SKILL = learning DIFFICULTY = excellent_skill_level }
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = botany_hawthornes BONUS = blood SCALE = 1 SKILL = learning DIFFICULTY = average_skill_level }
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = botany_hemlocks BONUS = water SCALE = 1 SKILL = learning DIFFICULTY = good_skill_level }
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = botany_horsetails BONUS = water SCALE = 1 SKILL = learning DIFFICULTY = average_skill_level }
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = botany_lightbanes BONUS = dark SCALE = 1 SKILL = learning DIFFICULTY = average_skill_level }
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = botany_lilies BONUS = light SCALE = 1 SKILL = learning DIFFICULTY = average_skill_level }
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = botany_marigolds BONUS = light SCALE = 1 SKILL = learning DIFFICULTY = average_skill_level }
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = botany_monkshoods BONUS = nature SCALE = 1 SKILL = learning DIFFICULTY = average_skill_level }
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = botany_passionflowers BONUS = blood SCALE = 1 SKILL = learning DIFFICULTY = average_skill_level }
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = botany_peppervines BONUS = fire SCALE = 1 SKILL = learning DIFFICULTY = average_skill_level }
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = botany_prunes BONUS = stewardship SCALE = 1 SKILL = learning DIFFICULTY = poor_skill_level }
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = botany_roses BONUS = blood SCALE = 1 SKILL = learning DIFFICULTY = poor_skill_level }
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = botany_shallots BONUS = stewardship SCALE = 1 SKILL = learning DIFFICULTY = good_skill_level }
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = botany_snowdrops BONUS = ice SCALE = 1 SKILL = learning DIFFICULTY = good_skill_level }
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = botany_stargazers BONUS = celestial SCALE = 1 SKILL = learning DIFFICULTY = good_skill_level }
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = botany_thistles BONUS = blood SCALE = 1 SKILL = learning DIFFICULTY = average_skill_level }
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = botany_willows BONUS = ethereal SCALE = 1 SKILL = learning DIFFICULTY = average_skill_level }
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = botany_yarrows BONUS = blood SCALE = 1 SKILL = learning DIFFICULTY = average_skill_level }
	
	##################
	# ARCANA - TOOLS #
	##################
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = sacrificial_dagger_design BONUS = blood SCALE = 2 SKILL = arcana DIFFICULTY = poor_skill_level }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = arcana SCALE = 1 }
	
	##################
	# ARCANA - LIGHT #
	##################
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = warding_mirrors BONUS = light SCALE = 1 SKILL = arcana DIFFICULTY = average_skill_level }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = metal SCALE = 1 }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = arcana SCALE = 1 }
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = mirror_spirit_interaction BONUS = light SCALE = 1 SKILL = arcana DIFFICULTY = good_skill_level }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = arcana SCALE = 1 }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = ethereal SCALE = 1 }
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = mirror_lich_interaction BONUS = light SCALE = 1 SKILL = arcana DIFFICULTY = poor_skill_level }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = dark SCALE = 1 }
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = laser_beam_spell_ke BONUS = learn_spell SCALE = 1 SKILL = light DIFFICULTY = excellent_skill_level }
	scope:new_knowledge_entry_scope ?= {
		add_to_variable_list = {
			name = knowledge_entry_spell_list
			target = global_var:laser_beam
		}
	}

	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = empty_island_corvanor BONUS = learn_spell SCALE = 1 SKILL = arcana DIFFICULTY = average_skill_level }
	scope:new_knowledge_entry_scope ?= {
		add_to_variable_list = {
			name = knowledge_entry_spell_list
			target = global_var:solar_bombardment
		}
	}
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = light SCALE = 1 }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = fire SCALE = 1 }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = arcana SCALE = 1 }
	
	##################
	# ARCANA - STONE #
	##################
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = preliminary_results BONUS = learn_spell SCALE = 1 SKILL = arcana DIFFICULTY = average_skill_level }
	scope:new_knowledge_entry_scope ?= {
		add_to_variable_list = {
			name = knowledge_entry_spell_list
			target = global_var:petrify
		}
	}
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = stone SCALE = 1 }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = blood SCALE = 1 }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = add_arcana_lifestyle_xp SCALE = 100 }
	
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = agata_rebirth_ke BONUS = learning SCALE = 1 SKILL = arcana DIFFICULTY = average_skill_level }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = stone SCALE = 1 }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = add_intrigue_lifestyle_xp SCALE = 100 }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = add_arcana_lifestyle_xp SCALE = 100 }
	
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = anti_magi_cockatrice BONUS = learning SCALE = 1 SKILL = arcana DIFFICULTY = average_skill_level }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = arcana SCALE = 1 }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = add_learning_lifestyle_xp SCALE = 100 }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = add_arcana_lifestyle_xp SCALE = 100 }
	
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = killer_discovered BONUS = learning SCALE = 2 SKILL = arcana DIFFICULTY = average_skill_level }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = arcana SCALE = 1 }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = intrigue SCALE = 2 }

	
	#################
	# ARCANA - DARK #
	#################
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = ship_quarreling_lover BONUS = add_arcana_lifestyle_xp SCALE = 300 SKILL = arcana DIFFICULTY = poor_skill_level }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = dark SCALE = 1 }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = arcana SCALE = 2 }

	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = nature_of_shade_infestation BONUS = add_arcana_lifestyle_xp SCALE = 300 SKILL = arcana DIFFICULTY = good_skill_level }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = dark SCALE = 2 }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = arcana SCALE = 2 }

	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = fall_of_relar_outpost BONUS = learn_spell SCALE = 1 SKILL = dark DIFFICULTY = excellent_skill_level }
	scope:new_knowledge_entry_scope ?= {
		add_to_variable_list = {
			name = knowledge_entry_spell_list
			target = global_var:shade_slayed
		}
	} #potentially add air teleport spell
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = dark SCALE = 3 }

	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = tales_of_extinction BONUS = add_arcana_lifestyle_xp SCALE = 300 SKILL = arcana DIFFICULTY = good_skill_level }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = add_learning_lifestyle_xp SCALE = 300 }	
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = learning SCALE = 2 }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = intrigue SCALE = 1 }


	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = on_embalming BONUS = add_trait_xp_lifestyle_physician SCALE = medium_trait_xp SKILL = learning DIFFICULTY = average_skill_level }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = dark SCALE = 1 }

	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = burial_rituals BONUS = learn_spell SCALE = 1 SKILL = ethereal DIFFICULTY = good_skill_level }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = ethereal SCALE = 1 }

	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = funeral_dirges BONUS = add_arcana_lifestyle_xp SCALE = 300 SKILL = arcana DIFFICULTY = excellent_skill_level }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = hymns SCALE = 1 }

	##################
	# ARCANA - BLOOD #
	##################
	# Runes
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = rune_four_valves BONUS = blood SCALE = 1 SKILL = blood DIFFICULTY = poor_skill_level }
	
	# Filler Knowledge
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = theorem_resonant_heartbeat BONUS = blood SCALE = 1 SKILL = blood DIFFICULTY = good_skill_level }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = add_trait_xp_lifestyle_physician SCALE = minor_trait_xp }
	
	# Other
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = kei_kassidius_diagrams BONUS = add_trait_xp_lifestyle_physician SCALE = major_trait_xp SKILL = arcana DIFFICULTY = average_skill_level }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = blood SCALE = 1 }
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = sound_of_veins_act_one BONUS = blood SCALE = 2 SKILL = intrigue DIFFICULTY = average_skill_level }
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = splendorous_mirrors_part_one BONUS = blood SCALE = 1 SKILL = arcana DIFFICULTY = average_skill_level }

	
	######################
	# ARCANA - CELESTIAL #
	######################
	# GH URGENT: Replace these missing spells with something else
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = detecting_malice_meditation BONUS = add_trait_xp_lifestyle_mystic SCALE = medium_trait_xp SKILL = lifestyle_mystic DIFFICULTY = 10 }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = celestial SCALE = 1 }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = light SCALE = 1 }
	#create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = aervalr_reading BONUS = learn_spell SCALE = 1 SKILL = arcana DIFFICULTY = average_skill_level }
	#scope:new_knowledge_entry_scope ?= {
	#	add_to_variable_list = {
	#		name = knowledge_entry_spell_list
	#		target = global_var:lunar_astrology
	#	}
	#}
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = celestial SCALE = 1 }
	#create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = star_cards BONUS = learn_spell SCALE = 1 SKILL = arcana DIFFICULTY = average_skill_level }
	#scope:new_knowledge_entry_scope ?= {
	#	add_to_variable_list = {
	#		name = knowledge_entry_spell_list
	#		target = global_var:lunar_astrology
	#	}
	#}
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = auspex_of_stewardship SCALE = 2 }
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = star_gazers BONUS = celestial SCALE = 1 SKILL = arcana DIFFICULTY = average_skill_level }

	#####################
	# ARCANA - ETHEREAL #
	#####################
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = spirit_interaction_rules BONUS = add_trait_xp_lifestyle_mystic SCALE = medium_trait_xp SKILL = lifestyle_mystic DIFFICULTY = 10 }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = ethereal SCALE = 3 }
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = lonely_spirit_experiment_log BONUS = ethereal SCALE = 2 SKILL = arcana DIFFICULTY = average_skill_level  }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = dream SCALE = 1 }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = arcana SCALE = 1 }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = sanity_loss SCALE = 1 }
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = lonely_spirit_personal_log BONUS = dark SCALE = 2 SKILL = learning DIFFICULTY = poor_skill_level  }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = intrigue SCALE = 1 }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = sanity_loss SCALE = 1 }
	
	################
	# ARCANA - AIR #
	################
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = wingspan_pinion BONUS = air SCALE = 1 SKILL = air DIFFICULTY = poor_skill_level }
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = digits_talons BONUS = dark SCALE = 1 SKILL = air DIFFICULTY = poor_skill_level }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = add_trait_xp_lifestyle_hunter_falconer_knowledge_entry_effect SCALE = medium_trait_xp }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = sanity_loss SCALE = 1 }
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = lenses_oracle BONUS = learn_spell SCALE = 1 SKILL = air DIFFICULTY = average_skill_level }
	scope:new_knowledge_entry_scope ?= {
		add_to_variable_list = {
			name = knowledge_entry_spell_list
			target = global_var:birdseye_oracle
		}
	}
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = air SCALE = 2 }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = dark SCALE = 2 }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = sanity_loss SCALE = 2 }
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = musings_on_flight_patterns BONUS = air SCALE = 2 SKILL = air DIFFICULTY = poor_skill_level }

	#################
	# ARCANA - WATER#
	#################
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = sea_queens_domain BONUS = water SCALE = 1 SKILL = water DIFFICULTY = poor_skill_level }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = water SCALE = 1 }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = arcana SCALE = 1 }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = hymns SCALE = 1 }
	
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = admiral_of_the_deep BONUS = learn_spell SCALE = 1 SKILL = water DIFFICULTY = good_skill_level }
	scope:new_knowledge_entry_scope ?= {
		add_to_variable_list = {
			name = knowledge_entry_spell_list
			target = global_var:calming_of_the_sea_queen
		}
	}
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = water SCALE = 1 }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = hymns SCALE = 1 }
	
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = minstrel_of_the_reef BONUS = learn_spell SCALE = 1 SKILL = water DIFFICULTY = excellent_skill_level }
	scope:new_knowledge_entry_scope ?= {
		add_to_variable_list = {
			name = knowledge_entry_spell_list
			target = global_var:anger_of_the_sea_queen
		}
	}
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = water SCALE = 1 }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = hymns SCALE = 1 }

	###################
	# ARCANA - NATURE #
	###################
	# Songwood
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = wisrutu BONUS = add_trait_xp_lifestyle_traveler_travel SCALE = medium_trait_xp SKILL = learning DIFFICULTY = average_skill_level }
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = iltyds_lament BONUS = intrigue SCALE = 1 SKILL = learning DIFFICULTY = poor_skill_level }
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = choir_of_laughing_shadows BONUS = add_trait_xp_lifestyle_traveler_danger SCALE = medium_trait_xp SKILL = nature DIFFICULTY = average_skill_level }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = nature SCALE = 2 }
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = spring_blessing BONUS = learn_spell SCALE = 1 SKILL = nature DIFFICULTY = good_skill_level }
	scope:new_knowledge_entry_scope ?= {
		add_to_variable_list = {
			name = knowledge_entry_spell_list
			target = global_var:verdant_growth
		}
	}
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = the_fell_one BONUS = add_arcana_lifestyle_xp SCALE = 300 SKILL = nature DIFFICULTY = excellent_skill_level }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = dark SCALE = 1 }
	# Arl Janvreep's World Tree Series
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = arl_janvreep_world_tree_weddings_in_the_glade BONUS = nature SCALE = 1 SKILL = nature DIFFICULTY = poor_skill_level }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = fire SCALE = 1 }
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = arl_janvreep_world_tree_mid_summer BONUS = nature SCALE = 2 SKILL = nature DIFFICULTY = poor_skill_level }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = add_character_modifier_GH_wanderlust_modifier SCALE = 1 }
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = arl_janvreep_world_tree_autumn_prayer BONUS = nature SCALE = 1 SKILL = nature DIFFICULTY = good_skill_level }

	
	##################
	# ARCANA - DREAM #
	##################
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = dream_maps_empyrean_tower BONUS = light SCALE = 5 SKILL = dream DIFFICULTY = good_skill_level }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = dream SCALE = 3 }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = arcana SCALE = 3 }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = sanity_loss SCALE = 2 }
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = key_of_the_obsidian_gate_ke BONUS = learn_spell SCALE = 1 SKILL = dream DIFFICULTY = good_skill_level }
	scope:new_knowledge_entry_scope ?= {
		add_to_variable_list = {
			name = knowledge_entry_spell_list
			target = global_var:key_of_the_obsidian_gate
		}
	}
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = wakeless_glass BONUS = dream SCALE = 1 SKILL = dream DIFFICULTY = poor_skill_level }
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = wakeless_rubies BONUS = dream SCALE = 3 SKILL = dream DIFFICULTY = good_skill_level }
	# GH TODO: Implement this spell
	#scope:new_knowledge_entry_scope ?= {
	#	add_to_variable_list = {
	#		name = knowledge_entry_spell_list
	#		target = global_var:create_wakeless
	#	}
	#}
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = wakeless_fire BONUS = dream SCALE = 1 SKILL = dream DIFFICULTY = average_skill_level }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = fire SCALE = 1 }
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = wakeless_incomprehensibilities BONUS = dream SCALE = 2 SKILL = dream DIFFICULTY = average_skill_level }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = sanity_loss SCALE = 1 }
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = neverending_dream_appendices BONUS = dream SCALE = 1 SKILL = dream DIFFICULTY = poor_skill_level }
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = neverending_dream_geese_questions BONUS = dream SCALE = 2 SKILL = intrigue DIFFICULTY = average_skill_level }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = intrigue SCALE = 1 }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = sanity_loss SCALE = 1 }
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = neverending_dream_roar_of_the_king BONUS = dream SCALE = 2 SKILL = dream DIFFICULTY = average_skill_level }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = nature SCALE = 2 }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = sanity_loss SCALE = 1 }
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = neverending_dream_spider_queen BONUS = learn_spell SCALE = 1 SKILL = dream DIFFICULTY = average_skill_level }
	scope:new_knowledge_entry_scope ?= {
		add_to_variable_list = {
			name = knowledge_entry_spell_list
			target = global_var:weavers_descent
		}
	}
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = dream SCALE = 2 }
	add_bonus_to_last_created_knowledge_entry_effect = { BONUS = sanity_loss SCALE = 1 }

	##################
	# ARCANA - DEATH #
	##################

	################
	# ARCANA - ICE #
	################

	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = germaines_journal_part_one BONUS = ice SCALE = 2 SKILL = arcana DIFFICULTY = average_skill_level }
}


initialize_wisemans_friend_knowledge_entries_effect = {
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = detecting_malice_meditation }
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = spirit_interaction_rules }
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = aervalr_reading }
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = star_cards }
}

initialize_greyfen_codex_knowledge_entries_effect = {
	assign_spell_knowledge_entry_effect = { SPELL = global_var:phylactery_of_the_trolls_blood }
	assign_spell_knowledge_entry_effect = { SPELL = global_var:rite_of_the_scarlet_kings_feast }
	assign_spell_knowledge_entry_effect = { SPELL = global_var:spawn_nature_elementals_army }
	assign_spell_knowledge_entry_effect = { SPELL = global_var:interior_journey }
	assign_spell_knowledge_entry_effect = { SPELL = global_var:invocation_of_the_wise_mother }
}

initialize_contents_of_silver_knowledge_entries_effect = {
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = warding_mirrors }
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = mirror_spirit_interaction }
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = mirror_lich_interaction }
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = laser_beam_spell_ke }
}

initialize_aeltheniax_anatomy_vol_1_knowledge_entries_effect = {
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = basics_of_human_anatomy }
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = three_humors }
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = mechanics_of_the_heart }
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = theorem_resonant_heartbeat }
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = rune_four_valves }
	#assign_spell_knowledge_entry_effect = { SPELL = global_var:rite_of_the_iron_vitae }
	#assign_spell_knowledge_entry_effect = { SPELL = global_var:phylactery_of_the_trolls_blood }
	#assign_spell_knowledge_entry_effect = { SPELL = global_var:phylactery_of_the_oxens_heart }
}

initialize_aeltheniax_anatomy_vol_2_knowledge_entries_effect = {
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = methods_of_vivisection }
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = vitae_extraction_and_storage }
	#assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = the_five_torments_procedure } # GH URGENT: This spell is commented
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = applied_mutations_and_flesh_graftings }
}

initialize_azure_tablet_knowledge_entries_effect = {
	assign_spell_knowledge_entry_effect = { SPELL = global_var:rite_of_the_scarlet_kings_feast }
	assign_spell_knowledge_entry_effect = { SPELL = global_var:invocation_of_the_red_frenzy }
	assign_spell_knowledge_entry_effect = { SPELL = global_var:seal_of_the_red_madness }
}

initialize_on_the_triune_blood_of_man_knowledge_entries_effect = {
	assign_spell_knowledge_entry_effect = { SPELL = global_var:humorsurge_pyrax }
	assign_spell_knowledge_entry_effect = { SPELL = global_var:humorsurge_syngos }
	assign_spell_knowledge_entry_effect = { SPELL = global_var:humorsurge_elemochis }
}

initialize_hippoxiad_knowledge_entries_effect = {
	assign_spell_knowledge_entry_effect = { SPELL = global_var:humorsurge_syngos }
	assign_spell_knowledge_entry_effect = { SPELL = global_var:rite_of_the_red_chain }
	assign_spell_knowledge_entry_effect = { SPELL = global_var:humorsurge_pyrax }
	assign_spell_knowledge_entry_effect = { SPELL = global_var:seal_of_the_red_madness }
}

initialize_songwood_knowledge_entries_effect = {
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = wisrutu }
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = iltyds_lament }
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = choir_of_laughing_shadows }
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = spring_blessing }
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = the_fell_one }
}

initialize_the_voyagers_knowledge_entries_effect = {
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = dream_maps_empyrean_tower }
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = key_of_the_obsidian_gate_ke }
}

initialize_clarifications_on_the_ivory_sea_knowledge_entries_effect = {
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = wakeless_glass }
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = wakeless_rubies }
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = wakeless_fire }
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = wakeless_incomprehensibilities }
}

initialize_neverending_dream_knowledge_entries_effect = {
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = neverending_dream_appendices }
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = neverending_dream_geese_questions }
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = neverending_dream_roar_of_the_king }
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = neverending_dream_spider_queen }
}

initialize_owl_dissections_knowledge_entries_effect = {
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = wingspan_pinion }
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = digits_talons }
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = lenses_oracle }
}

initialize_songs_of_the_sea_knowledge_entries_effect = {
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = sea_queens_domain }
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = duelist_adventurer }
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = admiral_of_the_deep }
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = minstrel_of_the_reef }
}
initialize_the_lost_cities_knowledge_entries_effect = {
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = ship_quarreling_lover }
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = empty_island_corvanor }
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = nature_of_shade_infestation }
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = fall_of_relar_outpost }
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = tales_of_extinction }
}

initialize_stony_affair_at_viridue_knowledge_entries_effect = {
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = preliminary_results }
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = agata_rebirth_ke }
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = anti_magi_cockatrice }
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = killer_discovered }

}

initialize_on_funerary_rites_of_oejeynica_entries_effect = {
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = on_embalming }
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = burial_rituals }
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = funeral_dirges }
}


initialize_kassidius_diagrams_entries_effect = {
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = kei_kassidius_diagrams }
}

initialize_godherja_entries_effect = {
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = godherja }
}

initialize_sound_of_veins_entries_effect = {
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = sound_of_veins_act_one }
}

initialize_splendorous_mirrors_entries_effect = {
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = splendorous_mirrors_part_one }
}

initialize_star_gazers_entries_effect = {
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = star_gazers }
}

initialize_musings_on_flight_patterns_entries_effect = {
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = musings_on_flight_patterns }
}

initialize_world_tree_entries_effect = {
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = arl_janvreep_world_tree_weddings_in_the_glade }
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = arl_janvreep_world_tree_mid_summer }
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = arl_janvreep_world_tree_autumn_prayer }
}

initialize_germaines_journal_entries_effect = {
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = germaines_journal_part_one }
}

initialize_testament_to_yunusfur_knowledge_entries_effect = {
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = testament_to_yunusfur_el_qulatha }
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = testament_to_yunusfur_hudi }
}

initialize_lonely_spirit_knowledge_entries_effect = {
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = lonely_spirit_experiment_log }
	assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = lonely_spirit_personal_log }
}

initialize_masen_malik_knowledge_entries_effect = {
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = collection_of_tasurmad_poetry BONUS = poetry SCALE = 2  SKILL = diplomacy DIFFICULTY = 0 }

	create_ciphered_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = beautiful_women_of_sar_naresh_cipher BONUS = solar_eclipse_dates SCALE = 2  SKILL = celestial DIFFICULTY = 6 CIPHER_SKILL = learning CIPHER_DIFFICULTY = 20 }
	create_ciphered_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = chronological_list_of_ritualist_prophets_cipher BONUS = solar_eclipse_dates SCALE = 2  SKILL = celestial DIFFICULTY = 6 CIPHER_SKILL = learning CIPHER_DIFFICULTY = 20 }
	create_ciphered_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = apricot_orchard_cipher BONUS = learn_spell SCALE = 2 SKILL = ethereal DIFFICULTY = 6 CIPHER_SKILL = learning CIPHER_DIFFICULTY = 20 }
	scope:new_knowledge_entry_scope ?= {
		add_to_variable_list = {
			name = knowledge_entry_spell_list
			target = global_var:ancestral_betrayal
		}
	}
	#create_ciphered_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = apricot_orchard_cipher BONUS = solar_eclipse_dates CIPHER_SKILL = learning CIPHER_DIFFICULTY = 20 }
	#create_ciphered_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = scholars_lunchtime_pie_cipher BONUS = solar_eclipse_dates CIPHER_SKILL = learning CIPHER_DIFFICULTY = 20 }
	#create_ciphered_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = beautiful_women_of_sar_naresh_cipher BONUS = solar_eclipse_dates CIPHER_SKILL = learning CIPHER_DIFFICULTY = 20 }
	#create_ciphered_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = recipe_for_succulent_almond_bassbila_riddle BONUS = solar_eclipse_dates CIPHER_SKILL = learning CIPHER_DIFFICULTY = 20 }
	#create_ciphered_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = various_sayings_of_kemsari_actors_and_prostitutes_cipher BONUS = solar_eclipse_dates CIPHER_SKILL = learning CIPHER_DIFFICULTY = 20 }
}

###########################
# PROCEDURAL BOOK EFFECTS #
###########################

add_random_magic_knowledge_entries_relevant_to_culture_effect = {
	save_temporary_scope_as = artifact_scope
	$CULTURE$ = {
		while = {
			count = $COUNT$
			random_list = {
				5 = {	# Random spell
					random_in_list = {
						variable = magic_school_list
						var:magic_school = {
							scope:artifact_scope = {
								set_variable = {
									name = magic_school
									value = prev
								}
							}
							random_in_list = {
								variable = spell_list
								limit = {
									save_temporary_scope_as = spell_to_add_to_grimoire
									NOT = {
										scope:artifact_scope = {
											has_variable_list = knowledge_entry_list
											any_in_list = {
												variable = knowledge_entry_list
												has_variable_list = knowledge_entry_spell_list
												this = scope:spell_to_add_to_grimoire
											}
										}
									}
								}
								save_temporary_scope_as = grimoire_spell_to_assign
								scope:artifact_scope = {
									assign_spell_knowledge_entry_effect = { SPELL = scope:grimoire_spell_to_assign }
								}
							}
						}
					}
				}
				#1 = { assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = detecting_malice_meditation } }
				#1 = { assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = basics_of_human_anatomy } }
				#1 = { assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = three_humors } }
				#1 = { assign_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = mechanics_of_the_heart } }
			}
		}
	}
}

add_random_spell_knowledge_entries_from_culture_magic_school_effect = {
	save_temporary_scope_as = artifact_scope
	$CULTURE$ = {
		random_in_list = {
			variable = magic_school_list
			var:magic_school = {
				scope:newly_created_artifact = {
					set_variable = {
						name = magic_school
						value = prev
					}
				}
				while = {
					count = $COUNT$
					random_list = {
						2 = {	# Existing ritual
							random_in_list = {
								variable = spell_list
								save_temporary_scope_as = grimoire_spell_to_assign
								scope:newly_created_artifact = {
									assign_spell_knowledge_entry_effect = { SPELL = scope:grimoire_spell_to_assign }
								}
							}
						}
						1 = {	# Procedural ritual
							save_temporary_scope_value_as = {
								name = generated_spell_level_scope
								value = {
									integer_range = { min = 1 max = 5 }
								}
							}
							generate_procedural_spell_effect = { LEVEL = scope:generated_spell_level_scope QUALITY = 0 }
							if = {
								limit = { exists = scope:new_spell_scope }
								scope:newly_created_artifact = {
									assign_spell_knowledge_entry_effect = { SPELL = scope:new_spell_scope }
								}
							}
						}
					}
				}
			}
		}
	}
}

###################
# BACKEND EFFECTS #
###################

assign_knowledge_entry_effect = {
	if = {
		limit = { exists = global_var:$KNOWLEDGE_ENTRY_IDENTIFIER$ }
		add_to_variable_list = {
			name = knowledge_entry_list
			target = global_var:$KNOWLEDGE_ENTRY_IDENTIFIER$
		}
	}
}

assign_spell_knowledge_entry_effect = {
	if = {
		limit = { exists = $SPELL$.var:knowledge_entry }
		add_to_variable_list = {
			name = knowledge_entry_list
			target = $SPELL$.var:knowledge_entry
		}
		$SPELL$.var:knowledge_entry = { save_scope_as = new_knowledge_entry_scope }
	}
	else = {
		random_ruler = {
			create_story = { #Empty story that's only used to hold data
				type = story_generic_storage
				save_scope_as = new_knowledge_entry_scope #This scope is used for adding tags
			}
		}
		if = {
			limit = { exists = scope:new_knowledge_entry_scope }
			$SPELL$ = {
				set_variable = {
					name = knowledge_entry
					value = scope:new_knowledge_entry_scope
				}
			}
			add_bonus_to_last_created_knowledge_entry_effect = {
				BONUS = learn_spell
				SCALE = 1
			}
			scope:new_knowledge_entry_scope ?= {
				set_variable = {
					name = knowledge_entry_skill
					value = $SPELL$.var:primary_aspect
				}
				set_variable = {
					name = knowledge_entry_difficulty
					value = {
						value = $SPELL$.spell_level_value
						multiply = 3
					}
				}
				add_to_variable_list = {
					name = knowledge_entry_spell_list
					target = $SPELL$
				}
				if = {
					limit = { NOT = { exists = var:knowledge_entry_spell } }
					set_variable = {
						name = knowledge_entry_spell
						value = $SPELL$
					}
				}
			}
			add_to_variable_list = {
				name = knowledge_entry_list
				target = scope:new_knowledge_entry_scope
			}
		}
	}
}

assign_magic_school_knowledge_entry_effect = {
	if = {
		limit = { exists = $MAGIC_SCHOOL$.var:knowledge_entry }
		add_to_variable_list = {
			name = knowledge_entry_list
			target = $MAGIC_SCHOOL$.var:knowledge_entry
		}
		$MAGIC_SCHOOL$.var:knowledge_entry = { save_scope_as = new_knowledge_entry_scope }
	}
	else = {
		random_ruler = {
			create_story = { #Empty story that's only used to hold data
				type = story_generic_storage
				save_scope_as = new_knowledge_entry_scope #This scope is used for adding tags
			}
		}
		if = {
			limit = { exists = scope:new_knowledge_entry_scope }
			$MAGIC_SCHOOL$ = {
				set_variable = {
					name = knowledge_entry
					value = scope:new_knowledge_entry_scope
				}
			}
			add_bonus_to_last_created_knowledge_entry_effect = {
				BONUS = learn_magic_school
				SCALE = 1
			}
			scope:new_knowledge_entry_scope ?= {
				set_variable = {
					name = knowledge_entry_skill
					value = flag:arcana
				}
				set_variable = {
					name = knowledge_entry_difficulty
					value = 12
				}
				if = {
					limit = { NOT = { exists = var:knowledge_entry_magic_school } }
					set_variable = {
						name = knowledge_entry_magic_school
						value = $MAGIC_SCHOOL$
					}
				}
			}
			add_to_variable_list = {
				name = knowledge_entry_list
				target = scope:new_knowledge_entry_scope
			}
		}
	}
}

create_knowledge_entry_effect = {
	if = {
		limit = { NOT = { exists = global_var:$KNOWLEDGE_ENTRY_IDENTIFIER$ } }
		random_ruler = {
			create_story = { #Empty story that's only used to hold data
				type = story_generic_storage
				save_scope_as = new_knowledge_entry_scope #This scope is used for adding tags
			}
		}
		if = {
			limit = { exists = scope:new_knowledge_entry_scope }
			set_global_variable = {
				name = $KNOWLEDGE_ENTRY_IDENTIFIER$
				value = scope:new_knowledge_entry_scope
			}
			add_bonus_to_last_created_knowledge_entry_effect = {
				BONUS = $BONUS$
				SCALE = $SCALE$
			}
			scope:new_knowledge_entry_scope ?= {
				set_variable = {
					name = knowledge_entry_name
					value = flag:$KNOWLEDGE_ENTRY_IDENTIFIER$
				}
				set_variable = {
					name = knowledge_entry_skill
					value = flag:$SKILL$
				}
				set_variable = {
					name = knowledge_entry_difficulty
					value = $DIFFICULTY$
				}
				save_scope_as = $KNOWLEDGE_ENTRY_IDENTIFIER$
			}
		}
	}
}

create_procedural_knowledge_entry_effect = {
	random_ruler = {
		create_story = { #Empty story that's only used to hold data
			type = story_generic_storage
			save_scope_as = new_knowledge_entry_scope #This scope is used for adding tags
		}
	}
	if = {
		limit = { exists = scope:new_knowledge_entry_scope }
		add_to_global_variable_list = {
			name = procedural_$BONUS$_knowledge_entry_list
			target = scope:new_knowledge_entry_scope
		}
		add_bonus_to_last_created_knowledge_entry_effect = {
			BONUS = $BONUS$
			SCALE = $SCALE$
		}
		scope:new_knowledge_entry_scope ?= {
			set_variable = {
				name = knowledge_entry_skill
				value = flag:$SKILL$
			}
			set_variable = {
				name = knowledge_entry_difficulty
				value = $DIFFICULTY$
			}
			set_variable = { name = knowledge_entry_type value = flag:$TYPE$ }
			generate_spell_name_effect = yes
		}
		add_to_variable_list = {
			name = knowledge_entry_list
			target = scope:new_knowledge_entry_scope
		}
	}
}

add_bonus_to_last_created_knowledge_entry_effect = {
	scope:new_knowledge_entry_scope ?= {
		add_to_variable_list = {
			name = knowledge_entry_bonus_list
			target = flag:$BONUS$
		}
		set_variable = $BONUS$
		set_variable = {
			name = $BONUS$_scale
			value = $SCALE$
		}
	}
}

create_ciphered_knowledge_entry_effect = {
	create_knowledge_entry_effect = { KNOWLEDGE_ENTRY_IDENTIFIER = $KNOWLEDGE_ENTRY_IDENTIFIER$ BONUS = $BONUS$ SCALE = $SCALE$ SKILL = $SKILL$ DIFFICULTY = $DIFFICULTY$ }
	if = {
		limit = { exists = scope:new_knowledge_entry_scope }
		scope:new_knowledge_entry_scope = {
			set_variable = {
				name = knowledge_entry_cipher_skill
				value = flag:$CIPHER_SKILL$
			}
			set_variable = {
				name = knowledge_entry_cipher_difficulty
				value = $CIPHER_DIFFICULTY$
			}
		}
	}
}

create_studyable_book_with_global_identifier_effect = {
	random_ruler = {
		create_story = { #Empty story that's only used to hold data
			type = story_generic_storage
			save_scope_as = new_studyable_book_scope #This scope is used for adding tags
		}
	}
	if = {
		limit = { exists = scope:new_studyable_book_scope }
		set_global_variable = {
			name = $BOOK_IDENTIFIER$
			value = scope:new_studyable_book_scope
		}
		scope:new_studyable_book_scope = {
			set_variable = { #Have the magic school remember its name
				name = unique_book_identifier
				value = flag:$BOOK_IDENTIFIER$
			}
			save_scope_as = $BOOK_IDENTIFIER$
		}
	}
}

learn_knowledge_entry_bonus_effect = {
	save_temporary_scope_as = learn_knowledge_entry_bonus_character_scope
	if = {
		limit = {
			scope:knowledge_entry_scope = {
				any_in_list = {
					variable = knowledge_entry_bonus_list 
					this = flag:$NAME$
				}
			}
		}
		scope:learn_knowledge_entry_bonus_character_scope = {
			$NAME$_knowledge_entry_effect = yes
			add_to_variable_list = {
				name = known_knowledge_entry_list
				target = scope:knowledge_entry_scope
			}
		}
	}
}

# OLD CRAP

initialize_all_study_chains_effect = {
	initialize_study_chain_effect = { NAME = legal_study }
	scope:legal_study = {
		add_study_node_effect = { 
			NAME = the_pillars_of_virtue 
			TYPE = book
			PREDECESSOR_NODE_NAME = none
			DIFFICULTY = 6
			REWARD_AMOUNT = minor_trait_xp
		}
		scope:the_pillars_of_virtue = {
			add_special_reward_effect = { NAME = learning_reward AMOUNT = 1 }
		}
		add_study_node_effect = { 
			NAME = the_records_of_the_first_wardens_court 
			TYPE = book 
			PREDECESSOR_NODE_NAME = the_pillars_of_virtue 
			DIFFICULTY = 8
			REWARD_AMOUNT = medium_trait_xp
		}
		scope:the_records_of_the_first_wardens_court = {
			add_special_reward_effect = { NAME = diplomacy_reward AMOUNT = 1 }
		}
		add_study_node_effect = { 
			NAME = the_book_of_days 
			TYPE = book 
			PREDECESSOR_NODE_NAME = the_records_of_the_first_wardens_court 
			DIFFICULTY = 16
			REWARD_AMOUNT = major_trait_xp
		}
		scope:the_book_of_days = {
			add_special_reward_effect = { NAME = stewardship_reward AMOUNT = 3 }
		}
		add_study_node_effect = {
			NAME = the_visions 
			TYPE = book 
			PREDECESSOR_NODE_NAME = the_book_of_days 
			DIFFICULTY = 10
			REWARD_AMOUNT = minor_trait_xp
		}
		scope:the_visions = {
			add_special_reward_effect = { NAME = learning_reward AMOUNT = 1 }
		}
		add_study_node_effect = {
			NAME = the_marginalia 
			TYPE = book 
			PREDECESSOR_NODE_NAME = the_visions 
			DIFFICULTY = 10
			REWARD_AMOUNT = medium_trait_xp
		}
		scope:the_marginalia = {
			add_special_reward_effect = { NAME = learning_reward AMOUNT = 1 }
		}
	}
}

initialize_study_chain_effect = {
	random_ruler = {
		create_story = {
			type = story_generic_storage
			save_scope_as = $NAME$
		}
	}
	if = {
		limit = { exists = scope:$NAME$ }
		scope:$NAME$ = {
			set_variable = {
				name = study_chain_name
				value = flag:$NAME$
			}
		}
		add_to_global_variable_list = {
			name = study_chains_list
			target = scope:$NAME$
		}
	}
}

add_study_node_effect = {
	random_ruler = {
		create_story = {
			type = story_generic_storage
			save_scope_as = $NAME$
		}
	}
	if = {
		limit = { exists = scope:$NAME$ }
		add_to_variable_list = {
			name = all_study_nodes_list
			target = scope:$NAME$
		}
		scope:$NAME$ = {
			set_variable = {
				name = study_node_name
				value = flag:$NAME$
			}
			set_variable = {
				name = study_node_type
				value = flag:$TYPE$
			}
			set_variable = {
				name = study_node_difficulty
				value = $DIFFICULTY$
			}
			set_variable = {
				name = study_node_reward_amount
				value = $REWARD_AMOUNT$
			}
		}
		if = {
			limit = {
				any_in_list = {
					variable = all_study_nodes_list
					var:study_node_name = flag:$PREDECESSOR_NODE_NAME$
				}
			}
			random_in_list = {
				variable = all_study_nodes_list
				limit = {
					var:study_node_name = flag:$PREDECESSOR_NODE_NAME$
				}
				save_scope_as = predecessor_node_scope
			}
			if = {
				limit = { exists = scope:predecessor_node_scope }
				scope:$NAME$ = {
					set_variable = {
						name = predecessor_node
						value = scope:predecessor_node_scope
					}
				}
				scope:predecessor_node_scope = {
					add_to_variable_list = {
						name = successor_nodes_list
						target = scope:$NAME$
					}
				}
				clear_saved_scope = predecessor_node_scope
			}
		}
		else = {
			add_to_variable_list = {
				name = initial_study_nodes_list
				target = scope:$NAME$
			}
		}
	}
}

add_special_reward_effect = {
	add_to_variable_list = {
		name = special_rewards_list
		target = flag:$NAME$
	}
	set_variable = {
		name = $NAME$
		value = $AMOUNT$
	}
}

get_study_chain_effect = {
	random_in_global_list = {
		variable = study_chains_list
		limit = { var:study_chain_name = flag:$NAME$ }
		save_scope_as = $NAME$
	}
}

get_random_next_study_node_effect = {
	save_temporary_scope_as = character_scope
	if = {
		limit = { exists = $CHAIN_SCOPE$ }
		$CHAIN_SCOPE$ = {
			random_in_list = {
				variable = all_study_nodes_list
				limit = {
					scope:character_scope = {
						NOR = {
							is_target_in_variable_list = {
								name = mastered_study_nodes_list
								target = prev
							}
							is_target_in_variable_list = {
								name = finished_study_nodes_list
								target = prev
							}
						}
					}
					OR = {
						NOT = { exists = var:predecessor_node }
						scope:character_scope = {	
							OR = {
								is_target_in_variable_list = {
									name = mastered_study_nodes_list
									target = prev.var:predecessor_node
								}
								is_target_in_variable_list = {
									name = finished_study_nodes_list
									target = prev.var:predecessor_node
								}
							}
						}
					}
				}
				save_scope_as = picked_study_node
			}
		}
	}
}

#######################
# SKILL CHECK EFFECTS #
#######################

execute_study_node_learning_check_effect = {
	if = {
		limit = { exists = $NODE_SCOPE$ }
		duel = {
			skill = learning
			value = $NODE_SCOPE$.var:study_node_difficulty
			10 = {
				desc = study_critical_success_tt
				trigger = {
					$NODE_SCOPE$ = { has_variable_list = special_rewards_list }
					exists = scope:studying_intensively
					NOT = {
						is_target_in_variable_list = {
							name = mastered_study_nodes_list
							target = $NODE_SCOPE$
						}
					}
				}
				compare_modifier = {
					value = scope:duel_value
					multiplier = 2
					max = 40
					min = -49
				}
				send_interface_toast = {
					title = study_critical_success_tt
					left_icon = root
					
					$SUCCESS_EFFECT$
					apply_study_node_reward_effects = { NODE_SCOPE = $NODE_SCOPE$ }
				}
				add_to_variable_list = {
					name = mastered_study_nodes_list
					target = $NODE_SCOPE$
				}
			}
			50 = {
				desc = study_success_tt
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3.5
					max = 40
					min = -49
				}
				modifier = {
					factor = 1.5
					exists = scope:studying_intensively
				}
				send_interface_toast = {
					title = study_success_tt
					left_icon = root
					
					$SUCCESS_EFFECT$
				}
				add_to_variable_list = {
					name = finished_study_nodes_list
					target = $NODE_SCOPE$
				}
			}
			50 = {
				desc = study_failure_tt
				compare_modifier = {
					value = scope:duel_value
					multiplier = -3.5
					min = -40
				}
				modifier = {
					factor = 0.75
					exists = scope:studying_intensively
				}
				send_interface_toast = {
					title = study_failure_tt
					left_icon = root
				}
			}
		}
	}
}

apply_study_node_reward_effects = {
	if = {
		limit = { exists = $NODE_SCOPE$.var:diplomacy_reward }
		add_diplomacy_skill = $NODE_SCOPE$.var:diplomacy_reward
	}
	if = {
		limit = { exists = $NODE_SCOPE$.var:martial_reward }
		add_martial_skill = $NODE_SCOPE$.var:martial_reward
	}
	if = {
		limit = { exists = $NODE_SCOPE$.var:stewardship_reward }
		add_stewardship_skill = $NODE_SCOPE$.var:stewardship_reward
	}
	if = {
		limit = { exists = $NODE_SCOPE$.var:intrigue_reward }
		add_intrigue_skill = $NODE_SCOPE$.var:intrigue_reward
	}
	if = {
		limit = { exists = $NODE_SCOPE$.var:learning_reward }
		add_learning_skill = $NODE_SCOPE$.var:learning_reward
	}
	if = {
		limit = { exists = $NODE_SCOPE$.var:prowess_reward }
		add_prowess_skill = $NODE_SCOPE$.var:prowess_reward
	}
}