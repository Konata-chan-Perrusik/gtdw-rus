
##################################################
# Tax Collector 
tax_collector_aptitude_miniscule_increase = { value = 5 }

tax_collector_aptitude_minor_increase = { value = 10 }

tax_collector_aptitude_medium_increase = { value = 15 }

tax_collector_aptitude_major_increase = { value = 20 }

tax_collector_aptitude_massive_increase = { value = 25 }


tax_collector_bailate_aptitude_score = {
		value = 1
	add = {
		value = diplomacy
		multiply = 1
		max = 50
		desc = court_position_skill_diplomacy
	}
	add = {
		value = martial
		multiply = 0.8
		max = 50
		desc = court_position_skill_martial
	}
	add = {
		value = stewardship
		multiply = 2
		max = 50
		desc = court_position_skill_stewardship
	}
	add = {
		value = intrigue
		multiply = 0.8
		max = 50
		desc = court_position_skill_intrigue
	}
	add = {
		value = learning
		multiply = 0.8
		max = 50
		desc = court_position_skill_learning
	}
	add = {
		value = prowess
		multiply = 0.8
		max = 50
		desc = court_position_skill_prowess
	}

	if = {
		limit = {
			has_trait = just
		}
		add = {
			value = 10
			desc = court_position_just_trait
		}
	}
	if = {
		limit = {
			has_trait = diplomat
		}
		add = {
			value = 10
			desc = court_position_diplomat_trait
		}
	}
	if = {
		limit = {
			has_trait = lifestyle_traveler
		}
		add = {
			value = 10
			desc = court_position_administrator_trait
		}
	}
	if = {
		limit = {
			has_trait = overseer
		}
		add = {
			value = 10
			desc = court_position_overseer_trait
		}
	}
	if = {
		limit = {
			has_character_modifier = fp3_capable_magistrates_modifier
		}
		add = {
			value = tax_collector_aptitude_major_increase
			desc = capable_magistrates_modifier
		}
	}
	if = {
		limit = {
			has_character_flag = fp3_inspired_tax_collector
		}
		add = {
			value = 20
			desc = fp3_inspired_tax_collector
		}
	}
	# Opinion of liege
	add = {
		desc = opinion_of_liege
		value = {
			if = {
				limit = {
					save_temporary_opinion_value_as = { name = target_opinion target = liege}
					scope:target_opinion >= very_high_positive_opinion
				}
				add = 20
			}
			else_if = {
				limit = {
					save_temporary_opinion_value_as = { name = target_opinion target = liege }
					scope:target_opinion >= high_positive_opinion
				}
				add = 15
			}
			else_if = {
				limit = {
					save_temporary_opinion_value_as = { name = target_opinion target = liege }
					scope:target_opinion >= medium_positive_opinion
				}
				add = 10
			}
			else_if = {
				limit = {
					save_temporary_opinion_value_as = { name = target_opinion target = liege }
					scope:target_opinion >= low_positive_opinion
				}
				add = 5
			}
			else = {
				add = 0
			}
		}
	}

	# Cultural Tradition
	if = {
		limit = {
			culture = { has_cultural_parameter = characters_are_better_tax_collector }
		}
		add = {
			value = tax_collector_aptitude_medium_increase
			desc = traditions_cheaper_value
		}
	}

	# Flag Check (for debug/event usage) - Use debug.9610
	if = {
		limit = { has_character_flag = is_guaranteed_excellent_tax_collector }
		add = 110
	}

	#todo replace with sheriffing traditions
	#add = court_position_aptitude_family_business_value

	# Viziers
	if = {
		limit = {
			liege = {
				exists = diarch
				has_diarchy_active_parameter = diarch_aptitude_helps_tax_collectors_toggle
			}
		}
		# Are we the vizier? If yes, we get a flat boost tied to our Scales of Power swing.
		if = {
			limit = { this = liege.diarch }
			add = {
				value = diarch_aptitude_helps_tax_collectors_buffed_by_swing_value
				desc = diarchy_tax_collector_boost.scales_of_power
			}
		}
		# Else we're someone different, so we get a fraction of the vizier's aptitude added to our own.
		else = {
			## Plenty of vizier's aptitude.
			if = {
				limit = {
					liege = { has_diarchy_active_parameter = diarch_aptitude_helps_tax_collectors_t4 }
				}
				add = {
					value = {
						value = liege.diarch.tax_collector_aptitude_score
						# But remove the buff the vizier got from the SoP swing or things'll get ridiculous.
						subtract = diarch_aptitude_helps_tax_collectors_buffed_by_swing_value
						# Now, reduce according to the correct percentage.
						multiply = diarch_aptitude_helps_tax_collectors_t4_value
						# Just in case, let's min things.
						min = 1
					}
					desc = diarchy_tax_collector_boost.diarch_aptitude.t4
				}
			}
			## Most of vizier's aptitude.
			else_if = {
				limit = {
					liege = { has_diarchy_active_parameter = diarch_aptitude_helps_tax_collectors_t3 }
				}
				add = {
					value = {
						value = liege.diarch.tax_collector_aptitude_score
						# But remove the buff the vizier got from the SoP swing or things'll get ridiculous.
						subtract = diarch_aptitude_helps_tax_collectors_buffed_by_swing_value
						# Now, reduce according to the correct percentage.
						multiply = diarch_aptitude_helps_tax_collectors_t3_value
						# Just in case, let's min things.
						min = 1
					}
					desc = diarchy_tax_collector_boost.diarch_aptitude.t3
				}
			}
			## Some of vizier's aptitude.
			else_if = {
				limit = {
					liege = { has_diarchy_active_parameter = diarch_aptitude_helps_tax_collectors_t2 }
				}
				add = {
					value = {
						value = liege.diarch.tax_collector_aptitude_score
						# But remove the buff the vizier got from the SoP swing or things'll get ridiculous.
						subtract = diarch_aptitude_helps_tax_collectors_buffed_by_swing_value
						# Now, reduce according to the correct percentage.
						multiply = diarch_aptitude_helps_tax_collectors_t2_value
						# Just in case, let's min things.
						min = 1
					}
					desc = diarchy_tax_collector_boost.diarch_aptitude.t2
				}
			}
			## A little of vizier's aptitude.
			else_if = {
				limit = {
					liege = { has_diarchy_active_parameter = diarch_aptitude_helps_tax_collectors_t1 }
				}
				add = {
					value = {
						value = liege.diarch.tax_collector_aptitude_score
						# But remove the buff the vizier got from the SoP swing or things'll get ridiculous.
						subtract = diarch_aptitude_helps_tax_collectors_buffed_by_swing_value
						# Now, reduce according to the correct percentage.
						multiply = diarch_aptitude_helps_tax_collectors_t1_value
						# Just in case, let's min things.
						min = 1
					}
					desc = diarchy_tax_collector_boost.diarch_aptitude.t1
				}
			}
		}
	}
}

tax_collector_order_magistrate_aptitude_score = {
	value = 1
	add = {
		value = diplomacy
		multiply = 0.8
		max = 50
		desc = court_position_skill_diplomacy
	}
	add = {
		value = martial
		multiply = 1
		max = 50
		desc = court_position_skill_martial
	}
	add = {
		value = stewardship
		multiply = 2
		max = 50
		desc = court_position_skill_stewardship
	}
	add = {
		value = intrigue
		multiply = 0.8
		max = 50
		desc = court_position_skill_intrigue
	}
	add = {
		value = learning
		multiply = 0.8
		max = 50
		desc = court_position_skill_learning
	}
	add = {
		value = prowess
		multiply = 1
		max = 50
		desc = court_position_skill_prowess
	}

	if = {
		limit = {
			has_trait = brave
		}
		add = {
			value = 10
			desc = court_position_brave_trait
		}
	}
	if = {
		limit = {
			has_trait = diplomat
		}
		add = {
			value = 10
			desc = court_position_diplomat_trait
		}
	}
	if = {
		limit = {
			has_trait = lifestyle_traveler
		}
		add = {
			value = 10
			desc = court_position_administrator_trait
		}
	}
	if = {
		limit = {
			has_trait = overseer
		}
		add = {
			value = 10
			desc = court_position_overseer_trait
		}
	}
	if = {
		limit = {
			has_character_modifier = fp3_capable_magistrates_modifier
		}
		add = {
			value = tax_collector_aptitude_major_increase
			desc = capable_magistrates_modifier
		}
	}
	if = {
		limit = {
			has_character_flag = fp3_inspired_tax_collector
		}
		add = {
			value = 20
			desc = fp3_inspired_tax_collector
		}
	}
	# Opinion of liege
	add = {
		desc = opinion_of_liege
		value = {
			if = {
				limit = {
					save_temporary_opinion_value_as = { name = target_opinion target = liege}
					scope:target_opinion >= very_high_positive_opinion
				}
				add = 20
			}
			else_if = {
				limit = {
					save_temporary_opinion_value_as = { name = target_opinion target = liege }
					scope:target_opinion >= high_positive_opinion
				}
				add = 15
			}
			else_if = {
				limit = {
					save_temporary_opinion_value_as = { name = target_opinion target = liege }
					scope:target_opinion >= medium_positive_opinion
				}
				add = 10
			}
			else_if = {
				limit = {
					save_temporary_opinion_value_as = { name = target_opinion target = liege }
					scope:target_opinion >= low_positive_opinion
				}
				add = 5
			}
			else = {
				add = 0
			}
		}
	}

	# Cultural Tradition
	if = {
		limit = {
			culture = { has_cultural_parameter = characters_are_better_tax_collector }
		}
		add = {
			value = tax_collector_aptitude_medium_increase
			desc = traditions_cheaper_value
		}
	}

	# Flag Check (for debug/event usage) - Use debug.9610
	if = {
		limit = { has_character_flag = is_guaranteed_excellent_tax_collector }
		add = 110
	}

	#todo replace with sheriffing traditions
	#add = court_position_aptitude_family_business_value

	# Viziers
	if = {
		limit = {
			liege = {
				exists = diarch
				has_diarchy_active_parameter = diarch_aptitude_helps_tax_collectors_toggle
			}
		}
		# Are we the vizier? If yes, we get a flat boost tied to our Scales of Power swing.
		if = {
			limit = { this = liege.diarch }
			add = {
				value = diarch_aptitude_helps_tax_collectors_buffed_by_swing_value
				desc = diarchy_tax_collector_boost.scales_of_power
			}
		}
		# Else we're someone different, so we get a fraction of the vizier's aptitude added to our own.
		else = {
			## Plenty of vizier's aptitude.
			if = {
				limit = {
					liege = { has_diarchy_active_parameter = diarch_aptitude_helps_tax_collectors_t4 }
				}
				add = {
					value = {
						value = liege.diarch.tax_collector_aptitude_score
						# But remove the buff the vizier got from the SoP swing or things'll get ridiculous.
						subtract = diarch_aptitude_helps_tax_collectors_buffed_by_swing_value
						# Now, reduce according to the correct percentage.
						multiply = diarch_aptitude_helps_tax_collectors_t4_value
						# Just in case, let's min things.
						min = 1
					}
					desc = diarchy_tax_collector_boost.diarch_aptitude.t4
				}
			}
			## Most of vizier's aptitude.
			else_if = {
				limit = {
					liege = { has_diarchy_active_parameter = diarch_aptitude_helps_tax_collectors_t3 }
				}
				add = {
					value = {
						value = liege.diarch.tax_collector_aptitude_score
						# But remove the buff the vizier got from the SoP swing or things'll get ridiculous.
						subtract = diarch_aptitude_helps_tax_collectors_buffed_by_swing_value
						# Now, reduce according to the correct percentage.
						multiply = diarch_aptitude_helps_tax_collectors_t3_value
						# Just in case, let's min things.
						min = 1
					}
					desc = diarchy_tax_collector_boost.diarch_aptitude.t3
				}
			}
			## Some of vizier's aptitude.
			else_if = {
				limit = {
					liege = { has_diarchy_active_parameter = diarch_aptitude_helps_tax_collectors_t2 }
				}
				add = {
					value = {
						value = liege.diarch.tax_collector_aptitude_score
						# But remove the buff the vizier got from the SoP swing or things'll get ridiculous.
						subtract = diarch_aptitude_helps_tax_collectors_buffed_by_swing_value
						# Now, reduce according to the correct percentage.
						multiply = diarch_aptitude_helps_tax_collectors_t2_value
						# Just in case, let's min things.
						min = 1
					}
					desc = diarchy_tax_collector_boost.diarch_aptitude.t2
				}
			}
			## A little of vizier's aptitude.
			else_if = {
				limit = {
					liege = { has_diarchy_active_parameter = diarch_aptitude_helps_tax_collectors_t1 }
				}
				add = {
					value = {
						value = liege.diarch.tax_collector_aptitude_score
						# But remove the buff the vizier got from the SoP swing or things'll get ridiculous.
						subtract = diarch_aptitude_helps_tax_collectors_buffed_by_swing_value
						# Now, reduce according to the correct percentage.
						multiply = diarch_aptitude_helps_tax_collectors_t1_value
						# Just in case, let's min things.
						min = 1
					}
					desc = diarchy_tax_collector_boost.diarch_aptitude.t1
				}
			}
		}
	}
}

tax_collector_boatswain_aptitude_score = {
	value = 1
	add = {
		value = diplomacy
		multiply = 0.8
		max = 50
		desc = court_position_skill_diplomacy
	}
	add = {
		value = martial
		multiply = 2
		max = 50
		desc = court_position_skill_martial
	}
	add = {
		value = stewardship
		multiply = 0.8
		max = 50
		desc = court_position_skill_stewardship
	}
	add = {
		value = intrigue
		multiply = 0.8
		max = 50
		desc = court_position_skill_intrigue
	}
	add = {
		value = dread
		multiply = 1
		max = 50
		desc = court_position_skill_dread
	}
	add = {
		value = prowess
		multiply = 0.8
		max = 50
		desc = court_position_skill_prowess
	}

	if = {
		limit = {
			has_trait = greedy
		}
		add = {
			value = 10
			desc = court_position_greedy_trait
		}
	}
	if = {
		limit = {
			has_trait = diplomat
		}
		add = {
			value = 10
			desc = court_position_diplomat_trait
		}
	}
	if = {
		limit = {
			has_trait = lifestyle_traveler
		}
		add = {
			value = 10
			desc = court_position_administrator_trait
		}
	}
	if = {
		limit = {
			has_trait = overseer
		}
		add = {
			value = 10
			desc = court_position_overseer_trait
		}
	}
	if = {
		limit = {
			has_character_modifier = fp3_capable_magistrates_modifier
		}
		add = {
			value = tax_collector_aptitude_major_increase
			desc = capable_magistrates_modifier
		}
	}
	if = {
		limit = {
			has_character_flag = fp3_inspired_tax_collector
		}
		add = {
			value = 20
			desc = fp3_inspired_tax_collector
		}
	}
	# Opinion of liege
	add = {
		desc = opinion_of_liege
		value = {
			if = {
				limit = {
					save_temporary_opinion_value_as = { name = target_opinion target = liege}
					scope:target_opinion >= very_high_positive_opinion
				}
				add = 20
			}
			else_if = {
				limit = {
					save_temporary_opinion_value_as = { name = target_opinion target = liege }
					scope:target_opinion >= high_positive_opinion
				}
				add = 15
			}
			else_if = {
				limit = {
					save_temporary_opinion_value_as = { name = target_opinion target = liege }
					scope:target_opinion >= medium_positive_opinion
				}
				add = 10
			}
			else_if = {
				limit = {
					save_temporary_opinion_value_as = { name = target_opinion target = liege }
					scope:target_opinion >= low_positive_opinion
				}
				add = 5
			}
			else = {
				add = 0
			}
		}
	}

	# Cultural Tradition
	if = {
		limit = {
			culture = { has_cultural_parameter = characters_are_better_tax_collector }
		}
		add = {
			value = tax_collector_aptitude_medium_increase
			desc = traditions_cheaper_value
		}
	}

	# Flag Check (for debug/event usage) - Use debug.9610
	if = {
		limit = { has_character_flag = is_guaranteed_excellent_tax_collector }
		add = 110
	}

	#todo replace with sheriffing traditions
	#add = court_position_aptitude_family_business_value

	# Viziers
	if = {
		limit = {
			liege = {
				exists = diarch
				has_diarchy_active_parameter = diarch_aptitude_helps_tax_collectors_toggle
			}
		}
		# Are we the vizier? If yes, we get a flat boost tied to our Scales of Power swing.
		if = {
			limit = { this = liege.diarch }
			add = {
				value = diarch_aptitude_helps_tax_collectors_buffed_by_swing_value
				desc = diarchy_tax_collector_boost.scales_of_power
			}
		}
		# Else we're someone different, so we get a fraction of the vizier's aptitude added to our own.
		else = {
			## Plenty of vizier's aptitude.
			if = {
				limit = {
					liege = { has_diarchy_active_parameter = diarch_aptitude_helps_tax_collectors_t4 }
				}
				add = {
					value = {
						value = liege.diarch.tax_collector_aptitude_score
						# But remove the buff the vizier got from the SoP swing or things'll get ridiculous.
						subtract = diarch_aptitude_helps_tax_collectors_buffed_by_swing_value
						# Now, reduce according to the correct percentage.
						multiply = diarch_aptitude_helps_tax_collectors_t4_value
						# Just in case, let's min things.
						min = 1
					}
					desc = diarchy_tax_collector_boost.diarch_aptitude.t4
				}
			}
			## Most of vizier's aptitude.
			else_if = {
				limit = {
					liege = { has_diarchy_active_parameter = diarch_aptitude_helps_tax_collectors_t3 }
				}
				add = {
					value = {
						value = liege.diarch.tax_collector_aptitude_score
						# But remove the buff the vizier got from the SoP swing or things'll get ridiculous.
						subtract = diarch_aptitude_helps_tax_collectors_buffed_by_swing_value
						# Now, reduce according to the correct percentage.
						multiply = diarch_aptitude_helps_tax_collectors_t3_value
						# Just in case, let's min things.
						min = 1
					}
					desc = diarchy_tax_collector_boost.diarch_aptitude.t3
				}
			}
			## Some of vizier's aptitude.
			else_if = {
				limit = {
					liege = { has_diarchy_active_parameter = diarch_aptitude_helps_tax_collectors_t2 }
				}
				add = {
					value = {
						value = liege.diarch.tax_collector_aptitude_score
						# But remove the buff the vizier got from the SoP swing or things'll get ridiculous.
						subtract = diarch_aptitude_helps_tax_collectors_buffed_by_swing_value
						# Now, reduce according to the correct percentage.
						multiply = diarch_aptitude_helps_tax_collectors_t2_value
						# Just in case, let's min things.
						min = 1
					}
					desc = diarchy_tax_collector_boost.diarch_aptitude.t2
				}
			}
			## A little of vizier's aptitude.
			else_if = {
				limit = {
					liege = { has_diarchy_active_parameter = diarch_aptitude_helps_tax_collectors_t1 }
				}
				add = {
					value = {
						value = liege.diarch.tax_collector_aptitude_score
						# But remove the buff the vizier got from the SoP swing or things'll get ridiculous.
						subtract = diarch_aptitude_helps_tax_collectors_buffed_by_swing_value
						# Now, reduce according to the correct percentage.
						multiply = diarch_aptitude_helps_tax_collectors_t1_value
						# Just in case, let's min things.
						min = 1
					}
					desc = diarchy_tax_collector_boost.diarch_aptitude.t1
				}
			}
		}
	}
}